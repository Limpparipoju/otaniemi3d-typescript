<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-list/iron-list.html">

<dom-module id="manga-reader">
  <template>

    <style>
      .page {
        display: flex;
        justify-content: center;
      }
      .separator {
        height: 5px;
      }
      .reader {
        background-color: #1f1f1f;
      }
      .controls {
        display: flex;
        justify-content: center;
      }
    </style>

    <iron-ajax id="mangaListAjax"
        url="../../assets/data/manga-list.json" handle-as="json"
        on-response="_getManga"
        auto>
    </iron-ajax>
    <iron-ajax id="mangaAjax"
        url="" handle-as="json"
        on-response="_getChapter">
    </iron-ajax>
    <iron-ajax id="chapterAjax"
        url="" handle-as="json"
        last-response="{{chapter}}">
    </iron-ajax>

    <paper-drawer-panel force-narrow>

      <paper-header-panel drawer fixed>
        <paper-toolbar>
          <div class="title">Drawer</div>
        </paper-toolbar>
        <div>Drawer content</div>
      </paper-header-panel>

      <paper-header-panel main condenses mode="waterfall">

        <paper-toolbar>
          <paper-icon-button icon="menu" paper-drawer-toggle>
          </paper-icon-button>
          <span class="flex"></span>
          <paper-icon-button icon="search" on-tap="search">
          </paper-icon-button>
          <div class="bottom title">Title</div>
        </paper-toolbar>

        <div class="reader">

          <template is="dom-repeat" items="[[chapter.images]]" as="page">
            <div class="page">
              <img height="[[_height(page)]]" width="[[_width(page)]]" src="[[_pageImage(page)]]">
            </div>
            <div class="separator"></div>
          </template>

          <div class="controls">
            <a href$="[[prevChapter]]">
              <paper-button>Previous</paper-button>
            </a>
            <a href$="[[nextChapter]]">
              <paper-button>Next</paper-button>
            </a>
          </div>

        </div>

      </paper-header-panel>

    </paper-drawer-panel>

  </template>
</dom-module>

<script src="manga-reader.js"></script>
